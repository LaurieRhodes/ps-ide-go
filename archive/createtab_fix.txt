func createNewTab() *ScriptTab {
	// Create GtkSourceView
	sourceViewPtr := C.gtk_source_view_new()
	sourceView := (*C.GtkSourceView)(unsafe.Pointer(sourceViewPtr))

	// Enable line numbers
	C.gtk_source_view_set_show_line_numbers(sourceView, C.TRUE)
	C.gtk_source_view_set_auto_indent(sourceView, C.TRUE)
	C.gtk_source_view_set_tab_width(sourceView, 4)

	// Get as GtkTextView for buffer access
	textView := (*C.GtkTextView)(unsafe.Pointer(sourceView))
	
	// Get the text buffer - it's already created by gtk_source_view_new
	bufferPtr := C.gtk_text_view_get_buffer(textView)
	
	// Create a new TextBuffer from the existing C buffer
	buffer, _ := gtk.TextBufferNew(nil)
	// Copy the pointer
	*(*unsafe.Pointer)(unsafe.Pointer(&buffer.Object.GObject)) = unsafe.Pointer(bufferPtr)

	// Set initial text
	buffer.SetText("# PowerShell Script\n# Enter your code here\n\nWrite-Host 'Hello from PS-IDE-Go!' -ForegroundColor Green\nGet-Date")

	// Wrap as GTK widget
	widgetPtr := (*C.GtkWidget)(unsafe.Pointer(sourceView))
	obj := glib.Take(unsafe.Pointer(widgetPtr))
	widget := &gtk.Widget{glib.InitiallyUnowned{obj}}

	// Create scrolled window
	scroll, _ := gtk.ScrolledWindowNew(nil, nil)
	scroll.Add(widget)

	// Create tab label
	tabLabel := createTabLabel(fmt.Sprintf("Untitled%d.ps1", tabCounter))
	tabCounter++

	tab := &ScriptTab{
		scrolledWindow: scroll,
		sourceView:     widget,
		buffer:         buffer,
		filename:       "",
		modified:       false,
		tabLabel:       tabLabel,
	}

	openTabs = append(openTabs, tab)

	pageNum := notebook.AppendPage(scroll, tabLabel)
	notebook.SetCurrentPage(pageNum)
	notebook.SetTabReorderable(scroll, true)

	buffer.Connect("notify::cursor-position", func() {
		updateCursorPosition(buffer)
	})

	buffer.Connect("changed", func() {
		tab.modified = true
		updateTabLabel(tab)
	})

	scroll.ShowAll()
	return tab
}
